/*!CK:4099398234!*//*1441003879,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["BdHGp"]); }

__d('FBRTCIncomingCallDialog',['AsyncDialog','AsyncRequest','BanzaiLogger','Dialog','setTimeoutAcrossTransitions','XIncomingCallDialogController','FBRTCSoundController','mixInEventEmitter'],function a(b,c,d,e,f,g,h,i,j,k,l,m,n,o){if(c.__markCompiled)c.__markCompiled();var p=70000;function q(r,s){'use strict';this.peerID=r;this.callID=s;this.$FBRTCIncomingCallDialog1=null;}q.prototype.showIncomingDialog=function(r){'use strict';var s=k.getCurrent();if(s)s.hide();var t=m.getURIBuilder().setInt('user_id',this.peerID).setInt('call_id',this.callID).setBool('video_on',r).getURI();this.$FBRTCIncomingCallDialog1=new i(t);h.send(this.$FBRTCIncomingCallDialog1,this.$FBRTCIncomingCallDialog2.bind(this));};q.prototype.$FBRTCIncomingCallDialog2=function(r){'use strict';if(!this.$FBRTCIncomingCallDialog1){setTimeout(function(){r.hide();},1);return;}this.$FBRTCIncomingCallDialog1=null;this.view=r;r.subscribe('confirm',this.$FBRTCIncomingCallDialog3.bind(this));r.subscribe('cancel',this.$FBRTCIncomingCallDialog4.bind(this));n.playIncomingRingtone(this.callID,this.peerID,true);this.timeout=l(this.$FBRTCIncomingCallDialog5.bind(this),p);};q.prototype.cancel=function(){'use strict';if(this.$FBRTCIncomingCallDialog1){this.$FBRTCIncomingCallDialog1.abort();this.$FBRTCIncomingCallDialog1=null;}if(this.timeout)clearTimeout(this.timeout);if(this.view){this.view.hide();this.view=null;}n.stopIncomingRingtone();};q.prototype.isForPeer=function(r){'use strict';return this.peerID===r;};q.prototype.isForCall=function(r){'use strict';return this.callID===r;};q.prototype.isForPeerAndCall=function(r,s){'use strict';return this.peerID===r&&this.callID===s;};q.prototype.$FBRTCIncomingCallDialog3=function(r,s){'use strict';this.cancel();j.log('VideoCallLoggerConfig',{event:'accept_call_click'});this.emit('answerCall',s.value);};q.prototype.$FBRTCIncomingCallDialog4=function(){'use strict';this.cancel();this.emit('ignoreCall');};q.prototype.$FBRTCIncomingCallDialog5=function(){'use strict';this.cancel();this.emit('timeout');};o(q,{answerCall:true,ignoreCall:true,timeout:true});f.exports=q;},null);